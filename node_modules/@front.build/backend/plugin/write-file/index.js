
var fs = require('fs')

module.exports = function(state, action, callback) {
  var files = action.input.Files
  var written = 0

  for (var i = 0, n = files.length; i < n; i++) {
    var file = files[i]
    write(file['File path'], file['File content'])
  }

  function write(path, content) {
    fs.writeFile(path, content, function(err){
      if (err) return callback(err)
      written++
      if (written == files.length) return callback()
    })
  }
}
