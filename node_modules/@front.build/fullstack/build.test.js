
var Build = require('./')
var assert = require('assert')

describe('Build', function(){
  it('should construct', function(){
    var build = new Build
  })

  it('should add plugins', function(done){
    var build = new Build
    build.plugin('Access state', function(state, action){
      assert(action.type)
      done()
    })
    build.dispatch({
      type: 'Access state'
    })
  })

  it('should allow adding state', function(done){
    var build = new Build
    build.plugin('Access state', function(state, action){
      if (!state.get('db')) {
        state.set('db', { value: true })
      }
      assert(state.get('db').value)
      done()
    })
    build.dispatch({
      type: 'Access state'
    })
  })

  it('should pass context', function(done){
    var build = new Build
    build.plugin('Access state', function(state, action){
      assert(state.context.value)
      done()
    })
    build.dispatch({
      type: 'Access state'
    }, {
      value: true
    })
  })
})
