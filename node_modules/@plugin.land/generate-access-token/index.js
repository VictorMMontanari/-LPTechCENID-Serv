
var ms = require('ms')

/**
 * JWT token created after a user logins passing openid scope to /authorize,
 * or after they authorize.
 */

module.exports = function(state, action) {
  var cert = action.input['Private SSL certificate']
  var password = action.input['Private SSL password']
  var audience = action.input['Audience']
  var expiresIn = action.input['Expires in'] || ms('15min')
  var issuer = action.input['Issuer']
  var user = action.input['User']
  var id = action.input.ID
  var data = action.input['Data'] || {}
  return state.dispatch({
    type: 'JWT sign',
    input: {
      'Private SSL certificate': cert,
      'Private SSL password': password,
      'Audience': audience,
      'Expires in': expiresIn,
      'Issuer': issuer,
      'User': user,
      'Data': data,
      'ID': id
    }
  })
}
